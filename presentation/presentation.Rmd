
---
title: "Sleep Health and Lifestyle Dataset"
subtitle: "Analiza jakości snu na podstawie stylu życia"
author: "StowarzyszenieOvi <br> viol68, Tamirami, rvai00"
institute: "Nicolaus Copernicus University in Toruń"
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    lib_dir: libs
    nature:
      ratio: "16:9"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---
```{r load-packages, include = FALSE}
# Add any additional packages you need to this chunk
library(tidyverse)
library(tidymodels)
library(palmerpenguins)
library(knitr)
library(xaringanthemer)
library(datasets)
library(ggplot2)
library(kableExtra)
library(corrplot)
library(cowplot)
library(viridis)
library(patchwork)
```

```{r setup, include=FALSE}
# For better figure resolution
knitr::opts_chunk$set(fig.retina = 3, dpi = 300, fig.width = 6, fig.asp = 0.618, out.width = "80%")
```

```{r, include=FALSE}
getwd()
```

```{r, include=FALSE}
# Specify the path to your CSV file
file_path <- "Sleep_dataset.csv"

# Load data from the CSV file into a data frame
Sleep_dataset <- read.csv(file_path)

```

```{r tło, echo=FALSE}

```

```{r theme, echo=FALSE}

style_xaringan(
  title_slide_background_image = "img/tłobluepink.png"
)

style_mono_accent(
  base_color = "#2C436F", # kolr tekstu nagłówka 
  background_color = "#D996A7", # kolor tła
  inverse_background_color = "#9AC3E6", # inverse kolor tła
  inverse_header_color = "#FFFFFF",     # linverse kolor nagłówka
  text_color = "#FFFFFF", # kolor tekstu
  inverse_text_color = "#FFFFFF" # inverse kolor tekstu
  ) 

```

class: center, middle

# Cel Badawczy
Nasze badanie ma na celu analizę zestawu danych dotyczących snu i stylu życia, ze szczególnym uwzględnieniem zawodów respondentów. Naszym głównym celem jest identyfikacja potencjalnych zależności i wzorców, przy skoncentrowaniu uwagi nie tylko na różnicach między poszczególnymi profesjami, ale także na powiązaniach z poziomem doświadczanego stresu. Chcemy lepiej zrozumieć, czy istnieją konkretne grupy zawodowe, które bardziej niż inne doświadczają trudności związanych ze snem i czy te trudności mogą być powiązane z poziomem stresu w danym środowisku zawodowym.

---
class: center, middle

# O bazie danych
Zestaw danych dotyczący snu i stylu życia zawiera 400 wierszy i 13 kolumn, obejmujących szeroki zakres zmiennych związanych ze snem i codziennymi nawykami. Zmienne, na podstawie których została wykonana analiza to:

```{r wyświetlenie_zmiennych, echo=FALSE}
names(Sleep_dataset)
```

---
class: inverse, center, middle

# Dane demograficzne:
```{r rozkład wieku, echo=FALSE, warning=FALSE}
# funkcja do ustawienia kolorów dla tytułów i tła wykresów
set_plot_colors <- function(plot, title_color, background_color) {
  plot + 
    theme(plot.title = element_text(color = title_color)) +
    theme(panel.background = element_rect(fill = background_color))
}
# wykres płci
plot_gender <- ggplot(Sleep_dataset, aes(x = Gender, fill = Gender)) +
  geom_bar(show.legend = FALSE) +
  geom_text(aes(label = after_stat(count)), stat = "count", vjust = 1.5, colour = "white") +
  labs(title = "Rozkład płci", x = "Płeć", y = "Liczba osób") +
  theme_xaringan() +
  theme(
    plot.background = element_rect(fill = "#9AC3E6")    # Kolor tła obszaru całego wykresu
  )

# wykres wieku
plot_age <- ggplot(Sleep_dataset, aes(x = Age, fill = Age)) +
  geom_histogram(binwidth = 5, position = "identity", fill = "#F28705") +
  scale_fill_viridis_c() +
  labs(title = "Rozkład Wieku", x = "Ilość osób", y = "Ilość osób") +
  theme_xaringan() +
  theme(
    plot.background = element_rect(fill = "#9AC3E6")    # Kolor tła obszaru całego wykresu
  )

# ustawienie kolorów tła 7
plot_gender <- set_plot_colors(plot_gender, "#2C436F", "#9AC3E6")
plot_age <- set_plot_colors(plot_age, "#2C436F", "#9AC3E6")

# umieszczenie wykresów na slajdzie obok siebie
combined_plot <- plot_grid(plot_gender, plot_age, ncol = 2)

print(combined_plot)
```

---

class: center, middle

# Najistotniejsze statystyki dla tej analizy:
```{r średnie_mediany, echo=FALSE}
#  średnie
averages <- Sleep_dataset %>%
  summarise(
    Sleep_Duration = mean(Sleep.Duration, na.rm = TRUE),
    Quality_of_Sleep = mean(Quality.of.Sleep, na.rm = TRUE),
    Stress_Level = mean(Stress.Level, na.rm = TRUE)
  )

# mediany
medians <- Sleep_dataset %>%
  summarise(
    Sleep_Duration = median(Sleep.Duration, na.rm = TRUE),
    Quality_of_Sleep = median(Quality.of.Sleep, na.rm = TRUE),
    Stress_Level = median(Stress.Level, na.rm = TRUE)
  )
```

```{r printing, echo=FALSE}
print("Średnie:")
print(averages)

print("Mediany:")
print(medians)

```

---

# Analiza korelacji między zmiennymi

```{r matrix, fig.height=10, fig.width=10, echo=FALSE}
#set.seed(42)
#cor(Sleep_dataset[c(3, 5, 6, 7, 8, 11, 12)])

numeric_Sleep_dataset <- Sleep_dataset[sapply(Sleep_dataset, is.numeric)]

correlation_matrix <- cor(numeric_Sleep_dataset)

corrplot(correlation_matrix, method="color", addCoef.col="black", tl.col="black", tl.srt=45)
```

---


```{r jakość_snu__vs_długość, echo=FALSE, warning=FALSE}
ggplot() + 
  geom_point(data = Sleep_dataset, mapping = aes(x = Quality.of.Sleep, y = Sleep.Duration)) +
  geom_smooth(data = Sleep_dataset, mapping = aes(x = Quality.of.Sleep, y = Sleep.Duration)) +
labs(title = "Wykres punktowy",
         subtitle = "Zależność między jakością a długością snu",
         x = "Jakość Snu",
         y = "Długość Snu") +
    theme_minimal()
```

---


```{r jakość_snu_vs_stres, echo=FALSE, warning=FALSE}
ggplot() + 
  geom_point(data = Sleep_dataset, mapping = aes(x = Stress.Level, y = Sleep.Duration)) +
  geom_smooth(data = Sleep_dataset, mapping = aes(x = Stress.Level, y = Sleep.Duration)) +
  labs(title = "Wykres punktowy",
         subtitle = "Zależnośś jakości snu od poziomu stresu",
         x = "Jakość Snu",
         y = "Poziom Stresu") +
    theme_minimal()
```

---

```{r steps_vs_stres, echo=FALSE}
ggplot(Sleep_dataset, aes(x = Daily.Steps, y = Stress.Level)) +
  geom_point() +
  labs(title = "Zależność ilości dziennych kroków od poziomu stresu",
       x = "Ilość kroków w ciągu dnia",
       y = "Poziom Stresu")
```

---

```{r zawody, echo=FALSE}
#Wykonywane zawody przez badanych
ggplot(Sleep_dataset, aes(x = Occupation, fill=Occupation)) +
  geom_bar() +
  labs(title = "Rozkład profesji", y = "Ilość osób") +
  theme(axis.text.x=element_text(size=10, angle=45,hjust=0.95))
```


---

#Długość snu w zależności od wykonywanego zawodu

```{r zawód_długość, echo=FALSE}
ggplot(Sleep_dataset, aes(y = `Sleep.Duration`)) +
  geom_bar() +
  labs(x = "Profesja", y = "Długość Snu") +
  theme(axis.text.x=element_text(size=7, angle=90,hjust=0.99)) +
  facet_wrap(vars(Occupation))
```

---

#Relacja między ilością wykonywanych kroków a profesją

```{r zawód_kroki, echo=FALSE}
ggplot() + 
  geom_boxplot(data = Sleep_dataset, mapping = aes(y = `Daily.Steps`, x = Occupation)) +
  theme(axis.text.x=element_text(size=10, angle=45,hjust=0.95))
```

---

#Relacja między profesją a poziomem stresu

```{r zawód_stres, echo=FALSE}
ggplot(Sleep_dataset, aes(x = Stress.Level, fill=as.factor(Stress.Level))) + 
  geom_bar() +
  labs(x = "Ilość", y = "Profesja") +
  scale_fill_discrete(name = "Poziom Stresu") +
  facet_wrap(vars(Occupation))
```

---
# Analiza występowania zaburzeń snu wśród różnych profesji

```{r zawód_zaburzenia, echo=FALSE} 
Sleep_dataset$Occupation <- factor(Sleep_dataset$Occupation, levels = unique(Sleep_dataset$Occupation))

# Create the plot
ggplot(Sleep_dataset, aes(x = Occupation, fill = Sleep.Disorder)) +
  geom_bar(position = "dodge", color = "black", alpha = 0.8) +
  labs(title = "Częstotliwość występowania zaburzeń snu",
       subtitle = "w poszczególnych profesjach",
       x = "Profesja",
       y = "Ilość",
       fill = "Zaburzenie snu") +
  scale_fill_manual(values = c("Sleep Apnea" = "lightblue", "Insomnia" = "salmon", "None" = "yellow")) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        legend.position = "top") +
  labs(fill = "Sleep Disorder")
```


---
class: inverse, center, middle

# Section title

---

# Hello World

- Click the `Knit` button to compile your presentation

- Make sure to commit and push all resulting files to your GitHub repo

---

class: inverse, middle, center

# Using xaringan

---

# xaringan

- The presentation is created using the `xaringan` package

- Use `---` to separate slides and `--` for incremental builds

--
 
- Like this

---

# Layouts

You can use plain text

- or bullet points

.pull-left[
or text in two columns $^*$
]
.pull-right[
- like
- this
]

.footnote[
[*] And add footnotes
]

---

# Code```{r boring-regression}
# a boring regression
model <- lm(dist ~ speed, data = cars)
tidy(model)
glance(model)
```
---

#Plots

```{r recode-species, echo = FALSE}
# In this chunk I'm doing a bunch of analysis that I don't want to present 
# in my slides. But I need the resulting data frame for a plot I want to present.
iris_modified <- iris |>
  mutate(Species = fct_other(Species, keep = "setosa"))
```

```{r plot-iris, echo = FALSE}
# Code hidden with echo = FALSE
# Uses modified iris dataset from previous chunk
# Play around with height and width until you're happy with the look
ggplot(data = iris_modified, mapping = aes(x = Sepal.Width, y = Sepal.Length, color = Species)) +
  geom_point() + 
  theme_minimal() # theme options: https://ggplot2.tidyverse.org/reference/ggtheme.html
```

---

## Plot and text

.pull-left[
- Some text
- goes here
]
.pull-right[
```{r warning=FALSE, out.width="100%", fig.width=4, echo=FALSE}
# see how I changed out.width and fig.width from defaults
# to make the figure bigger
ggplot(penguins, aes(x = bill_length_mm, y = species, color = species)) +
  geom_boxplot() +
  theme_minimal()
```
]

---

# Tables

If you want to generate a table, make sure it is in the HTML format (instead of Markdown or other formats), e.g.,

```{r iris-table, echo = FALSE}
kable(head(iris), format = "html")
```

---

# Images

```{r castle, echo = FALSE, out.width = "60%", fig.align = "center", fig.cap = "Image credit: Photo by Jörg Angeli on Unsplash."}
include_graphics("https://images.unsplash.com/photo-1535448033526-c0e85c9e6968?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1650&q=80")
```

Or you can also include a full page image. See next slide.

---

background-image: url(https://images.unsplash.com/photo-1535448033526-c0e85c9e6968?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1650&q=80)

---

# Math Expressions

You can write LaTeX math expressions inside a pair of dollar signs, e.g. &#36;\alpha+\beta$ renders $\alpha+\beta$. You can use the display style with double dollar signs:

```
$$\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i$$
```

$$\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i$$

Limitations:

1. The source code of a LaTeX math expression must be in one line, unless it is inside a pair of double dollar signs, in which case the starting `$$` must appear in the very beginning of a line, followed immediately by a non-space character, and the ending `$$` must be at the end of a line, led by a non-space character;

1. There should not be spaces after the opening `$` or before the closing `$`.

1. Math does not work on the title slide (see [#61](https://github.com/yihui/xaringan/issues/61) for a workaround).

---

# Feeling adventurous?

- Want to find out more about `xaringan`? See https://slides.yihui.name/xaringan/#1.

- You are welcomed to use the default styling of the slides. In fact, that's what I expect majority of you will do. You will differentiate yourself with the content of your presentation.

- But some of you might want to play around with slide styling. The 
`xaringanthemer` provides some solutions for this that: https://pkg.garrickadenbuie.com/xaringanthemer.

- And if you want more bells and whistles, there is also `xaringanExtra`: https://pkg.garrickadenbuie.com/xaringanExtra.
